#!/bin/bash

rm -rf *egg*
rm -rf dist/uclgeog_msc*
here=`pwd`


conda env update --file environment.yml
conda activate msc_core

echo "--------------------"
echo "# conda config"
echo "--------------------"
conda config --set anaconda_upload yes

echo "--------------------"
echo "# conda build"
echo "--------------------"

cd ..
conda-build uclgeog_msc_core

echo "--------------------"
echo "# conda install -c proflewis uclgeog_msc"
echo "--------------------"
conda install -c proflewis uclgeog_msc --yes

echo "--------------------"
echo "# conda upgrade -c proflewis uclgeog_msc"
echo "--------------------"
conda upgrade -c proflewis uclgeog_msc --yes

echo "--------------------"
echo "# conda install -c conda-forge jupyter_contrib_nbextensions"
echo "--------------------"
conda install -c conda-forge jupyter_contrib_nbextensions --yes

echo "--------------------"
echo "# conda upgrade -c conda-forge jupyter_contrib_nbextensions"
echo "--------------------"
conda upgrade -c conda-forge jupyter_contrib_nbextensions --yes

cd "${here}"
bash postBuild
conda build purge

